-- Удаление таблиц
DROP TABLE IF EXISTS ДетальРаботы, Жалоба, Работа, ВидРаботы, Заказ, Клиент, Автомобиль, Модель, Мастер, Деталь;
GO

-- Создание таблиц
CREATE TABLE Модель (
  Код INT IDENTITY PRIMARY KEY,
  Название VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE Автомобиль (
  Код INT IDENTITY PRIMARY KEY,
  КодМодели INT NOT NULL REFERENCES Модель(Код) ON DELETE CASCADE,
  НомернойЗнак VARCHAR(20) NOT NULL UNIQUE,
  ГодВыпуска INT NOT NULL
);

CREATE TABLE Клиент (
  Код INT IDENTITY PRIMARY KEY,
  Имя VARCHAR(50) NOT NULL,
  Фамилия VARCHAR(50) NOT NULL,
  Телефон VARCHAR(15) NOT NULL,
  Адрес VARCHAR(200)
);

CREATE TABLE Заказ (
  Код INT IDENTITY PRIMARY KEY,
  ДатаНачала DATE NOT NULL DEFAULT GETDATE(),
  ДатаОкончания DATE,
  КодКлиента INT NOT NULL REFERENCES Клиент(Код) ON DELETE CASCADE,
  КодАвтомобиля INT NOT NULL REFERENCES Автомобиль(Код) ON DELETE CASCADE
);

CREATE TABLE Мастер (
  Код INT IDENTITY PRIMARY KEY,
  Имя VARCHAR(50) NOT NULL,
  Фамилия VARCHAR(50) NOT NULL,
  Телефон VARCHAR(15),
  Специализация VARCHAR(100)
);

CREATE TABLE ВидРаботы (
  Код INT IDENTITY PRIMARY KEY,
  Название VARCHAR(100) NOT NULL
);

CREATE TABLE Работа (
  Код INT IDENTITY PRIMARY KEY,
  КодЗаказа INT NOT NULL REFERENCES Заказ(Код) ON DELETE CASCADE,
  КодМастера INT NOT NULL REFERENCES Мастер(Код) ON DELETE CASCADE,
  Описание VARCHAR(200) NOT NULL,
  Стоимость MONEY NOT NULL CHECK (Стоимость > 0),
  КодВидаРаботы INT NOT NULL REFERENCES ВидРаботы(Код) ON DELETE CASCADE
);

CREATE TABLE Жалоба (
  Код INT IDENTITY PRIMARY KEY,
  КодРаботы INT NOT NULL REFERENCES Работа(Код) ON DELETE CASCADE,
  Описание VARCHAR(200) NOT NULL,
  Дата DATE NOT NULL
);

CREATE TABLE Деталь (
  Код INT IDENTITY PRIMARY KEY,
  Название VARCHAR(100) NOT NULL,
  Стоимость MONEY NOT NULL CHECK (Стоимость > 0),
  Производитель VARCHAR(100) NOT NULL
);

CREATE TABLE ДетальРаботы (
  Код INT IDENTITY PRIMARY KEY,
  КодРаботы INT NOT NULL REFERENCES Работа(Код) ON DELETE CASCADE,
  КодДетали INT NOT NULL REFERENCES Деталь(Код) ON DELETE CASCADE,
  Количество INT NOT NULL
);
GO

-- Добавление данных в таблицы
INSERT INTO Модель (Название) 
VALUES 
  ('Toyota Camry'), 
  ('Honda Accord'), 
  ('BMW 3 Series'), 
  ('Audi A4'), 
  ('Mercedes-Benz C-Class'),
  ('Ford Focus'), 
  ('Volkswagen Passat'), 
  ('Hyundai Sonata'), 
  ('Kia Optima'), 
  ('Nissan Altima'),
  ('Mazda 6'), 
  ('Chevrolet Malibu'), 
  ('Lexus ES'), 
  ('Subaru Legacy'), 
  ('Tesla Model 3');
GO

INSERT INTO Автомобиль (КодМодели, НомернойЗнак, ГодВыпуска) 
VALUES
  (1, '1111KL-3', 2020), 
  (2, '2222IO-1', 2021), 
  (3, '3333AA-4', 2012), 
  (4, '4444AO-6', 2025), 
  (5, '5555BH-3', 2023), 
  (6, '6666IE-2', 2008), 
  (7, '7777ZX-9', 2019), 
  (8, '8888QP-8', 2015), 
  (9, '9999RR-7', 2020), 
  (10, '1010TT-6', 2014), 
  (11, '1111UU-5', 2016), 
  (12, '1212VV-4', 2017), 
  (13, '1313WW-3', 2021), 
  (14, '1414XX-2', 2022), 
  (15, '1515YY-1', 2023);
GO

INSERT INTO Клиент (Имя, Фамилия, Телефон, Адрес) 
VALUES
  ('Иван', 'Соколов', '1234567890', 'Москва, ул. Пушкина'), 
  ('Петр', 'Волков', '2345678901', 'Санкт-Петербург, ул. Ленина'),
  ('Сергей', 'Павлов', '3456789012', 'Екатеринбург, ул. Советская'), 
  ('Алексей', 'Яковлев', '4567890123', 'Новосибирск, ул. Гагарина'),
  ('Дмитрий', 'Дмитриев', '5678901234', 'Казань, ул. Мира'),
  ('Андрей', 'Попов', '6789012345', 'Краснодар, ул. Лермонтова'),
  ('Владимир', 'Кузнецов', '7890123456', 'Самара, ул. Чехова'),
  ('Никита', 'Орлов', '8901234567', 'Тюмень, ул. Ленина'),
  ('Геннадий', 'Белов', '9012345678', 'Уфа, ул. Свердлова'),
  ('Олег', 'Козлов', '0123456789', 'Омск, ул. Карла Маркса'),
  ('Василий', 'Морозов', '1123456789', 'Пермь, ул. Кирова'),
  ('Игорь', 'Зайцев', '2123456789', 'Волгоград, ул. Баумана'),
  ('Роман', 'Федоров', '3123456789', 'Ростов-на-Дону, ул. Красная'),
  ('Артем', 'Куликов', '4123456789', 'Челябинск, ул. Пушкина'),
  ('Максим', 'Семенов', '5123456789', 'Воронеж, ул. Победы');
GO

INSERT INTO Заказ (ДатаНачала, ДатаОкончания, КодКлиента, КодАвтомобиля) 
VALUES
  ('2024-01-01', '2024-01-20', 1, 1), 
  ('2024-01-01', '2024-02-05', 2, 2), 
  ('2024-01-02', '2024-01-06', 3, 3), 
  ('2024-01-02', '2024-01-04', 4, 4), 
  ('2024-01-05', '2024-01-21', 5, 5), 
  ('2024-01-20', '2024-01-24', 6, 6),
  ('2024-01-10', '2024-02-01', 7, 7), 
  ('2024-01-12', '2024-02-02', 8, 8),
  ('2024-01-15', '2024-02-05', 9, 9), 
  ('2024-01-18', '2024-02-10', 10, 10),
  ('2024-01-22', '2024-02-12', 11, 11), 
  ('2024-01-25', '2024-02-15', 12, 12),
  ('2024-01-27', '2024-02-18', 13, 13), 
  ('2024-01-29', '2024-02-20', 14, 14),
  ('2024-01-30', '2024-02-25', 15, 15);
GO

INSERT INTO ВидРаботы (Название) 
VALUES 
  ('Ремонт двигателя'), 
  ('Замена колес'), 
  ('Покраска автомобиля'), 
  ('Техническое обслуживание'), 
  ('Замена масла'), 
  ('Ремонт КПП'), 
  ('Шумоизоляция'), 
  ('Полировка кузова'), 
  ('Чип-тюнинг'), 
  ('Ремонт тормозной системы'),
  ('Диагностика подвески'), 
  ('Замена свечей зажигания'), 
  ('Обслуживание кондиционера'),
  ('Антикоррозийная обработка'), 
  ('Проверка электросистемы'),
  ('Проверка тормозной системы');
GO

INSERT INTO Мастер (Имя, Фамилия, Телефон, Специализация) 
VALUES
  ('Николай', 'Михайлов', '+375294653451', 'Слесарь'), 
  ('Григорий', 'Иванов', '+37529260472', 'Электрик'),
  ('Игорь', 'Петров', '+37529263483', 'Механик'), 
  ('Михаил', 'Смирнов', '+375291354604', 'Техник'), 
  ('Олег', 'Попов', '+375291640715', 'Сварщик'),
  ('Александр', 'Федоров', '+375294654321', 'Автоэлектрик'),
  ('Евгений', 'Сидоров', '+375295678912', 'Диагност'),
  ('Антон', 'Васильев', '+375296789123', 'Техник-моторист'),
  ('Даниил', 'Тихонов', '+375297890234', 'Мастер кузовного ремонта'),
  ('Станислав', 'Громов', '+375298901345', 'Специалист по тюнингу');
GO

INSERT INTO Работа (КодЗаказа, КодМастера, Описание, Стоимость, КодВидаРаботы) 
VALUES
  (1, 1, 'Ремонт двигателя (замена поршней)', 12000.00, 1), 
  (1, 2, 'Замена колес (летние на зимние)', 2500.00, 2),
  (2, 3, 'Покраска переднего бампера', 5000.00, 3), 
  (2, 4, 'Комплексное тех. обслуживание', 4500.00, 4),
  (3, 5, 'Замена масла и фильтров', 1700.00, 5),  
  (4, 6, 'Ремонт коробки передач', 9500.00, 6),  
  (5, 7, 'Полировка фар и кузова', 2800.00, 8),  
  (5, 8, 'Ремонт подвески', 8200.00, 10),  
  (6, 9, 'Диагностика электросистемы', 3500.00, 15),  
  (7, 10, 'Проверка и регулировка развала-схождения', 1800.00, 11),
  (8, 2, 'Установка шумоизоляции', 7500.00, 7),  
  (8, 3, 'Ремонт тормозной системы', 6400.00, 10),  
  (9, 4, 'Замена свечей зажигания', 2000.00, 12),  
  (9, 5, 'Промывка топливной системы', 3800.00, 13),  
  (10, 6, 'Замена амортизаторов', 6000.00, 10),  
  (10, 7, 'Ремонт стартера', 4400.00, 15),  
  (10, 8, 'Обслуживание кондиционера', 3000.00, 14),  
  (10, 9, 'Антикоррозийная обработка днища', 5600.00, 14),  
  (10, 10, 'Чип-тюнинг двигателя', 8900.00, 9),  
  (10, 1, 'Перетяжка салона (кожа)', 13500.00, 16);
GO

INSERT INTO Деталь (Название, Стоимость, Производитель)
VALUES
  ('Тормозные колодки', 1500.00, 'Bosch'),
  ('Амортизатор', 1200.00, 'KYB'),
  ('Масляный фильтр', 300.00, 'Bosch'),
  ('Моторное масло', 500.00, 'Castrol'),
  ('Аккумулятор', 2000.00, 'Varta'),
  ('Генератор', 5000.00, 'Bosch'),
  ('Топливный насос', 3500.00, 'Delphi'),
  ('Ремень ГРМ', 4000.00, 'Gates'),
  ('Катушка зажигания', 2200.00, 'NGK'),
  ('Свечи зажигания', 1000.00, 'Denso');
GO

INSERT INTO ДетальРаботы (КодРаботы, КодДетали, Количество)
VALUES
  (1, 1, 4),  
  (1, 2, 2),  
  (2, 3, 1),  
  (3, 4, 2),  
  (3, 5, 3),  
  (4, 6, 1),  
  (5, 7, 1),  
  (6, 8, 2),  
  (7, 9, 5),  
  (8, 10, 3),  
  (8, 1, 2),  
  (9, 2, 4),  
  (9, 3, 1),  
  (10, 4, 2),  
  (10, 5, 2),  
  (11, 6, 3),  
  (12, 7, 1),  
  (13, 8, 1),  
  (14, 9, 4),  
  (15, 10, 2);
GO

INSERT INTO Жалоба (КодРаботы, Описание, Дата) 
VALUES 
  (1, 'Двигатель плохо заводится после ремонта', '2024-03-01'),  
  (2, 'Колеса не сбалансированы после замены', '2024-02-15'),  
  (3, 'Краска немного отличается по оттенку', '2024-02-20'),  
  (5, 'Масляный фильтр не заменен', '2024-03-02'),  
  (8, 'Подвеска жестче, чем раньше', '2024-02-28'),  
  (10, 'После ремонта стартера машина не заводится', '2024-03-10'),  
  (12, 'После промывки топливной системы повысился расход топлива', '2024-03-07'),  
  (15, 'Амортизаторы скрипят при движении', '2024-02-18'),  
  (18, 'Чип-тюнинг увеличил расход топлива', '2024-03-05'),  
  (20, 'Перетяжка салона выполнена с дефектами', '2024-03-11');
GO
